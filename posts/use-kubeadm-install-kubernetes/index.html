<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>使用 kubeadm 安装 kubernetes | Bitqiu</title>
<meta name=keywords content="kubernetes,ops">
<meta name=description content="使用 kubeadm 安装 kubernetes - Bitqiu">
<meta name=author content="Bitqiu">
<link rel=canonical href=https://blog.bitqiu.cc/posts/use-kubeadm-install-kubernetes/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.b9ff4cc257e914dab489bd18086151800e18f91456a5174bf28489210227a659.css integrity="sha256-uf9MwlfpFNq0ib0YCGFRgA4Y+RRWpRdL8oSJIQInplk=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.bitqiu.cc/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://blog.bitqiu.cc/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://blog.bitqiu.cc/favicon-32x32.png>
<link rel=apple-touch-icon href=https://blog.bitqiu.cc/apple-touch-icon.png>
<link rel=mask-icon href=https://blog.bitqiu.cc/apple-touch-icon.png>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.87.0">
<meta property="og:title" content="使用 kubeadm 安装 kubernetes">
<meta property="og:description" content>
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.bitqiu.cc/posts/use-kubeadm-install-kubernetes/"><meta property="og:image" content="https://blog.bitqiu.cc/blog-cover.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-03-16T11:18:20+00:00">
<meta property="article:modified_time" content="2021-03-16T11:18:20+00:00"><meta property="og:site_name" content="Bitqiu blog">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.bitqiu.cc/blog-cover.png">
<meta name=twitter:title content="使用 kubeadm 安装 kubernetes">
<meta name=twitter:description content>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.bitqiu.cc/posts/"},{"@type":"ListItem","position":2,"name":"使用 kubeadm 安装 kubernetes","item":"https://blog.bitqiu.cc/posts/use-kubeadm-install-kubernetes/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"使用 kubeadm 安装 kubernetes","name":"使用 kubeadm 安装 kubernetes","description":"","keywords":["kubernetes","ops"],"articleBody":"配置要求  2核4G 的服务器 Cent OS 7.8  修改 hostname # 修改 hostname hostnamectl set-hostname kubernetes # 查看修改结果 hostnamectl status # 设置 hostname 解析 echo \"127.0.0.1 $(hostname)\"  /etc/hosts # 此处 hostname 的输出将会是该机器在 Kubernetes 集群中的节点名字 # 不能使用 localhost 作为节点的名字 cat /etc/redhat-release hostname 检查网络 在所有节点执行命令\n[root@k8s-master ~]# ip route show default via 10.1.2.2 dev ens33 proto static metric 100 10.1.2.0/24 dev ens33 proto kernel scope link src 10.1.2.100 metric 100 [root@k8s-master ~]# ip address 1: lo:  mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 2: ens33:  mtu 1500 qdisc pfifo_fast state UP group default qlen 1000 link/ether 00:0c:29:2e:35:42 brd ff:ff:ff:ff:ff:ff inet 10.1.2.100/24 brd 10.1.2.255 scope global noprefixroute ens33 valid_lft forever preferred_lft forever inet6 fe80::a3e8:7936:50da:d341/64 scope link noprefixroute valid_lft forever preferred_lft forever  kubelet使用的IP地址\n ip route show 命令中，可以知道机器的默认网卡，通常是 eth0，如 default via 10.1.2.2 dev eth0 ip address 命令中，可显示默认网卡的 IP 地址，Kubernetes 将使用此 IP 地址与集群内的其他节点通信，如 10.1.2.100 所有节点上 Kubernetes 所使用的 IP 地址必须可以互通（无需 NAT 映射、无安全组或防火墙隔离）   安装 containerd / kubelet / kubeadm / kubectl 使用 root 身份在所有节点执行如下代码，以安装软件：\n containerd nfs-utils kubectl / kubeadm / kubelet  手动执行以下代码，结果与快速安装相同。请将脚本第79行（已高亮）的 ${1} 替换成您需要的版本号，例如 1.17.4\n docker hub 镜像请根据自己网络的情况任选一个\n 第四行为腾讯云 docker hub 镜像 第六行为DaoCloud docker hub 镜像 第八行为阿里云 docker hub 镜像   # 在 master 节点和 worker 节点都要执行 # 最后一个参数 1.20.1 用于指定 kubenetes 版本，支持所有 1.20.x 版本的安装 # 腾讯云 docker hub 镜像 # export REGISTRY_MIRROR=\"https://mirror.ccs.tencentyun.com\" # DaoCloud 镜像 # export REGISTRY_MIRROR=\"http://f1361db2.m.daocloud.io\" # 阿里云 docker hub 镜像 export REGISTRY_MIRROR=https://registry.cn-hangzhou.aliyuncs.com 在 master 节点和 worker 节点都要执行\n#!/bin/bash  # 在 master 节点和 worker 节点都要执行 # 安装 containerd # 参考文档如下 # https://kubernetes.io/docs/setup/production-environment/container-runtimes/#containerd cat overlay br_netfilter EOF sudo modprobe overlay sudo modprobe br_netfilter # Setup required sysctl params, these persist across reboots. cat net.bridge.bridge-nf-call-iptables = 1 net.ipv4.ip_forward = 1 net.bridge.bridge-nf-call-ip6tables = 1 EOF # Apply sysctl params without reboot sysctl --system # 卸载旧版本 yum remove -y containerd.io # 设置 yum repository yum install -y yum-utils device-mapper-persistent-data lvm2 yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo # 安装 containerd yum install -y containerd.io-1.4.3 mkdir -p /etc/containerd containerd config default  /etc/containerd/config.toml sed -i \"s#k8s.gcr.io#registry.aliyuncs.com/k8sxio#g\" /etc/containerd/config.toml sed -i '/containerd.runtimes.runc.options/a\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ SystemdCgroup = true' /etc/containerd/config.toml sed -i \"s#https://registry-1.docker.io#${REGISTRY_MIRROR}#g\" /etc/containerd/config.toml systemctl daemon-reload systemctl enable containerd systemctl restart containerd # 安装 nfs-utils # 必须先安装 nfs-utils 才能挂载 nfs 网络存储 yum install -y nfs-utils yum install -y wget # 关闭 防火墙 systemctl stop firewalld systemctl disable firewalld # 关闭 SeLinux setenforce 0 sed -i \"s/SELINUX=enforcing/SELINUX=disabled/g\" /etc/selinux/config # 关闭 swap swapoff -a yes | cp /etc/fstab /etc/fstab_bak cat /etc/fstab_bak |grep -v swap  /etc/fstab # 配置K8S的yum源 cat /etc/yum.repos.d/kubernetes.repo [kubernetes] name=Kubernetes baseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64 enabled=1 gpgcheck=0 repo_gpgcheck=0 gpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg EOF # 卸载旧版本 yum remove -y kubelet kubeadm kubectl # 安装kubelet、kubeadm、kubectl # 将 ${1} 替换为 kubernetes 版本号，例如 1.20.1 yum install -y kubelet-${1} kubeadm-${1} kubectl-${1} crictl config runtime-endpoint /run/containerd/containerd.sock # 重启 docker，并启动 kubelet systemctl daemon-reload systemctl enable kubelet \u0026\u0026 systemctl start kubelet containerd --version kubelet --version 初始化 master 节点 # 只在 master 节点执行 # 替换 x.x.x.x 为 master 节点的内网IP # export 命令只在当前 shell 会话中有效，开启新的 shell 窗口后，如果要继续安装过程，请重新执行此处的 export 命令 export MASTER_IP=x.x.x.x # 替换 apiserver.demo 为 您想要的 dnsName export APISERVER_NAME=apiserver.demo # Kubernetes 容器组所在的网段，该网段安装完成后，由 kubernetes 创建，事先并不存在于您的物理网络中 export POD_SUBNET=10.100.0.1/16 echo \"${MASTER_IP}${APISERVER_NAME}\"  /etc/hosts #!/bin/bash  # 只在 master 节点执行 # 脚本出错时终止执行 set -e if [ ${#POD_SUBNET} -eq 0 ] || [ ${#APISERVER_NAME} -eq 0 ]; then echo -e \"\\033[31;1m请确保您已经设置了环境变量 POD_SUBNET 和 APISERVER_NAME \\033[0m\" echo 当前POD_SUBNET=$POD_SUBNET echo 当前APISERVER_NAME=$APISERVER_NAME exit 1 fi # 查看完整配置选项 https://godoc.org/k8s.io/kubernetes/cmd/kubeadm/app/apis/kubeadm/v1beta2 rm -f ./kubeadm-config.yaml cat ./kubeadm-config.yaml --- apiVersion: kubeadm.k8s.io/v1beta2 kind: ClusterConfiguration kubernetesVersion: v${1} imageRepository: registry.aliyuncs.com/k8sxio controlPlaneEndpoint: \"${APISERVER_NAME}:6443\" networking: serviceSubnet: \"10.96.0.0/16\" podSubnet: \"${POD_SUBNET}\" dnsDomain: \"cluster.local\" --- apiVersion: kubelet.config.k8s.io/v1beta1 kind: KubeletConfiguration cgroupDriver: systemd EOF # kubeadm init # 根据您服务器网速的情况，您需要等候 3 - 10 分钟 echo \"\" echo \"抓取镜像，请稍候...\" kubeadm config images pull --config=kubeadm-config.yaml echo \"\" echo \"初始化 Master 节点\" kubeadm init --config=kubeadm-config.yaml --upload-certs # 配置 kubectl rm -rf /root/.kube/ mkdir /root/.kube/ cp -i /etc/kubernetes/admin.conf /root/.kube/config # 安装 calico 网络插件 # 参考文档 https://docs.projectcalico.org/v3.13/getting-started/kubernetes/self-managed-onprem/onpremises echo \"\" echo \"安装calico-3.17.1\" rm -f calico-3.17.1.yaml kubectl create -f https://kuboard.cn/install-script/v1.20.x/calico-operator.yaml wget https://kuboard.cn/install-script/v1.20.x/calico-custom-resources.yaml sed -i \"s#192.168.0.0/16#${POD_SUBNET}#\" calico-custom-resources.yaml kubectl create -f calico-custom-resources.yaml 检查 master 初始化结果\n# 只在 master 节点执行 # 执行如下命令，等待 3-10 分钟，直到所有的容器组处于 Running 状态 watch kubectl get pod -n kube-system -o wide # 查看 master 节点初始化结果 kubectl get nodes -o wide 初始化 worker节点 获得 join命令参数 在 master 节点上执行\nkubeadm token create --print-join-command 可获取kubeadm join 命令及参数，如下所示\n# kubeadm token create 命令的输出 kubeadm join apiserver.demo:6443 --token mpfjma.4vjjg8flqihor4vt --discovery-token-ca-cert-hash sha256:6f7a8e40a810323672de5eee6f4d19aa2dbdb38411845a1bf5dd63485c43d303 初始化worker 针对所有的 worker 节点执行\n# 只在 worker 节点执行 # 替换 x.x.x.x 为 master 节点的内网 IP export MASTER_IP=x.x.x.x # 替换 apiserver.demo 为初始化 master 节点时所使用的 APISERVER_NAME export APISERVER_NAME=apiserver.demo echo \"${MASTER_IP}${APISERVER_NAME}\"  /etc/hosts # 替换为 master 节点上 kubeadm token create 命令的输出 kubeadm join apiserver.demo:6443 --token mpfjma.4vjjg8flqihor4vt --discovery-token-ca-cert-hash sha256:6f7a8e40a810323672de5eee6f4d19aa2dbdb38411845a1bf5dd63485c43d303 检查初始化结果 在 master 节点上执行\nkubectl get nodes -o wide 输出结果如下所示：\n[root@k8s-master ~]# kubectl get nodes NAME STATUS ROLES AGE VERSION k8s-master Ready master 3m46s v1.17.4 k8s-node Ready  2m20s v1.17.4 ","wordCount":"802","inLanguage":"en","datePublished":"2021-03-16T11:18:20Z","dateModified":"2021-03-16T11:18:20Z","author":{"@type":"Person","name":"Bitqiu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.bitqiu.cc/posts/use-kubeadm-install-kubernetes/"},"publisher":{"@type":"Organization","name":"Bitqiu","logo":{"@type":"ImageObject","url":"https://blog.bitqiu.cc/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<noscript>
<style type=text/css>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://blog.bitqiu.cc/ accesskey=h title="Bitqiu (Alt + H)">Bitqiu</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://blog.bitqiu.cc/archives title=Archive>
<span>Archive</span>
</a>
</li>
<li>
<a href=https://blog.bitqiu.cc/posts title=Posts>
<span>Posts</span>
</a>
</li>
<li>
<a href=https://blog.bitqiu.cc/tags title=Tags>
<span>Tags</span>
</a>
</li>
<li>
<a href=https://blog.bitqiu.cc/search title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://blog.bitqiu.cc/>Home</a>&nbsp;»&nbsp;<a href=https://blog.bitqiu.cc/posts/>Posts</a></div>
<h1 class=post-title>
使用 kubeadm 安装 kubernetes
</h1>
<div class=post-meta>March 16, 2021&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Bitqiu&nbsp;|&nbsp;<a href=https://github.com/bitqiu/bitqiu.github.io/tree/hugo/content/posts/use-kubeadm-install-kubernetes.md rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<div class=details>Table of Contents</div>
</summary>
<div class=inner><ul>
<li>
<a href=#%e9%85%8d%e7%bd%ae%e8%a6%81%e6%b1%82 aria-label=配置要求>配置要求</a></li>
<li>
<a href=#%e4%bf%ae%e6%94%b9-hostname aria-label="修改 hostname">修改 hostname</a></li>
<li>
<a href=#%e6%a3%80%e6%9f%a5%e7%bd%91%e7%bb%9c aria-label=检查网络>检查网络</a></li>
<li>
<a href=#%e5%ae%89%e8%a3%85-containerd--kubelet--kubeadm--kubectl aria-label="安装 containerd / kubelet / kubeadm / kubectl">安装 containerd / kubelet / kubeadm / kubectl</a></li>
<li>
<a href=#%e5%88%9d%e5%a7%8b%e5%8c%96-master-%e8%8a%82%e7%82%b9 aria-label="初始化 master 节点">初始化 master 节点</a></li>
<li>
<a href=#%e5%88%9d%e5%a7%8b%e5%8c%96-worker%e8%8a%82%e7%82%b9 aria-label="初始化 worker节点">初始化 worker节点</a><ul>
<li>
<a href=#%e8%8e%b7%e5%be%97-join%e5%91%bd%e4%bb%a4%e5%8f%82%e6%95%b0 aria-label="获得 join命令参数">获得 join命令参数</a></li>
<li>
<a href=#%e5%88%9d%e5%a7%8b%e5%8c%96worker aria-label=初始化worker>初始化worker</a></li>
<li>
<a href=#%e6%a3%80%e6%9f%a5%e5%88%9d%e5%a7%8b%e5%8c%96%e7%bb%93%e6%9e%9c aria-label=检查初始化结果>检查初始化结果</a>
</li>
</ul>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><h2 id=配置要求>配置要求<a hidden class=anchor aria-hidden=true href=#配置要求>#</a></h2>
<ul>
<li>2核4G 的服务器</li>
<li>Cent OS 7.8</li>
</ul>
<h2 id=修改-hostname>修改 hostname<a hidden class=anchor aria-hidden=true href=#修改-hostname>#</a></h2>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># 修改 hostname</span>
hostnamectl set-hostname kubernetes
<span style=color:#75715e># 查看修改结果</span>
hostnamectl status
<span style=color:#75715e># 设置 hostname 解析</span>
echo <span style=color:#e6db74>&#34;127.0.0.1   </span><span style=color:#66d9ef>$(</span>hostname<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> &gt;&gt; /etc/hosts

<span style=color:#75715e># 此处 hostname 的输出将会是该机器在 Kubernetes 集群中的节点名字</span>
<span style=color:#75715e># 不能使用 localhost 作为节点的名字</span>
cat /etc/redhat-release
hostname
</code></pre></div><h2 id=检查网络>检查网络<a hidden class=anchor aria-hidden=true href=#检查网络>#</a></h2>
<p>在所有节点执行命令</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># ip route show</span>
default via 10.1.2.2 dev ens33 proto static metric <span style=color:#ae81ff>100</span>
10.1.2.0/24 dev ens33 proto kernel scope link src 10.1.2.100 metric <span style=color:#ae81ff>100</span>

<span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># ip address</span>
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span style=color:#ae81ff>65536</span> qdisc noqueue state UNKNOWN group default qlen <span style=color:#ae81ff>1000</span>
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span style=color:#ae81ff>1500</span> qdisc pfifo_fast state UP group default qlen <span style=color:#ae81ff>1000</span>
    link/ether 00:0c:29:2e:35:42 brd ff:ff:ff:ff:ff:ff
    inet 10.1.2.100/24 brd 10.1.2.255 scope global noprefixroute ens33
       valid_lft forever preferred_lft forever
    inet6 fe80::a3e8:7936:50da:d341/64 scope link noprefixroute
       valid_lft forever preferred_lft forever
</code></pre></div><blockquote>
<p>kubelet使用的IP地址</p>
<ul>
<li><code>ip route show</code> 命令中，可以知道机器的默认网卡，通常是 <code>eth0</code>，如 <em><strong>default via 10.1.2.2 dev eth0</strong></em></li>
<li><code>ip address</code> 命令中，可显示默认网卡的 IP 地址，Kubernetes 将使用此 IP 地址与集群内的其他节点通信，如 <code>10.1.2.100</code></li>
<li>所有节点上 Kubernetes 所使用的 IP 地址必须可以互通（无需 NAT 映射、无安全组或防火墙隔离）</li>
</ul>
</blockquote>
<h2 id=安装-containerd--kubelet--kubeadm--kubectl>安装 containerd / kubelet / kubeadm / kubectl<a hidden class=anchor aria-hidden=true href=#安装-containerd--kubelet--kubeadm--kubectl>#</a></h2>
<p>使用 root 身份在所有节点执行如下代码，以安装软件：</p>
<ul>
<li>containerd</li>
<li>nfs-utils</li>
<li>kubectl / kubeadm / kubelet</li>
</ul>
<p>手动执行以下代码，结果与快速安装相同。<em><strong>请将脚本第79行（已高亮）的 ${1} 替换成您需要的版本号，例如 1.17.4</strong></em></p>
<blockquote>
<p>docker hub 镜像请根据自己网络的情况任选一个</p>
<ul>
<li>第四行为腾讯云 docker hub 镜像</li>
<li>第六行为DaoCloud docker hub 镜像</li>
<li>第八行为阿里云 docker hub 镜像</li>
</ul>
</blockquote>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># 在 master 节点和 worker 节点都要执行</span>
<span style=color:#75715e># 最后一个参数 1.20.1 用于指定 kubenetes 版本，支持所有 1.20.x 版本的安装</span>
<span style=color:#75715e># 腾讯云 docker hub 镜像</span>
<span style=color:#75715e># export REGISTRY_MIRROR=&#34;https://mirror.ccs.tencentyun.com&#34;</span>
<span style=color:#75715e># DaoCloud 镜像</span>
<span style=color:#75715e># export REGISTRY_MIRROR=&#34;http://f1361db2.m.daocloud.io&#34;</span>
<span style=color:#75715e># 阿里云 docker hub 镜像</span>
export REGISTRY_MIRROR<span style=color:#f92672>=</span>https://registry.cn-hangzhou.aliyuncs.com
</code></pre></div><p><strong>在 master 节点和 worker 节点都要执行</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e>#!/bin/bash
</span><span style=color:#75715e></span>
<span style=color:#75715e># 在 master 节点和 worker 节点都要执行</span>

<span style=color:#75715e># 安装 containerd</span>
<span style=color:#75715e># 参考文档如下</span>
<span style=color:#75715e># https://kubernetes.io/docs/setup/production-environment/container-runtimes/#containerd</span>

cat <span style=color:#e6db74>&lt;&lt;EOF | sudo tee /etc/modules-load.d/containerd.conf
</span><span style=color:#e6db74>overlay
</span><span style=color:#e6db74>br_netfilter
</span><span style=color:#e6db74>EOF</span>

sudo modprobe overlay
sudo modprobe br_netfilter

<span style=color:#75715e># Setup required sysctl params, these persist across reboots.</span>
cat <span style=color:#e6db74>&lt;&lt;EOF | sudo tee /etc/sysctl.d/99-kubernetes-cri.conf
</span><span style=color:#e6db74>net.bridge.bridge-nf-call-iptables  = 1
</span><span style=color:#e6db74>net.ipv4.ip_forward                 = 1
</span><span style=color:#e6db74>net.bridge.bridge-nf-call-ip6tables = 1
</span><span style=color:#e6db74>EOF</span>

<span style=color:#75715e># Apply sysctl params without reboot</span>
sysctl --system

<span style=color:#75715e># 卸载旧版本</span>
yum remove -y containerd.io

<span style=color:#75715e># 设置 yum repository</span>
yum install -y yum-utils device-mapper-persistent-data lvm2
yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

<span style=color:#75715e># 安装 containerd</span>
yum install -y containerd.io-1.4.3

mkdir -p /etc/containerd
containerd config default &gt; /etc/containerd/config.toml

sed -i <span style=color:#e6db74>&#34;s#k8s.gcr.io#registry.aliyuncs.com/k8sxio#g&#34;</span>  /etc/containerd/config.toml
sed -i <span style=color:#e6db74>&#39;/containerd.runtimes.runc.options/a\ \ \ \ \ \ \ \ \ \ \ \ SystemdCgroup = true&#39;</span> /etc/containerd/config.toml
sed -i <span style=color:#e6db74>&#34;s#https://registry-1.docker.io#</span><span style=color:#e6db74>${</span>REGISTRY_MIRROR<span style=color:#e6db74>}</span><span style=color:#e6db74>#g&#34;</span>  /etc/containerd/config.toml


systemctl daemon-reload
systemctl enable containerd
systemctl restart containerd


<span style=color:#75715e># 安装 nfs-utils</span>
<span style=color:#75715e># 必须先安装 nfs-utils 才能挂载 nfs 网络存储</span>
yum install -y nfs-utils
yum install -y wget

<span style=color:#75715e># 关闭 防火墙</span>
systemctl stop firewalld
systemctl disable firewalld

<span style=color:#75715e># 关闭 SeLinux</span>
setenforce <span style=color:#ae81ff>0</span>
sed -i <span style=color:#e6db74>&#34;s/SELINUX=enforcing/SELINUX=disabled/g&#34;</span> /etc/selinux/config

<span style=color:#75715e># 关闭 swap</span>
swapoff -a
yes | cp /etc/fstab /etc/fstab_bak
cat /etc/fstab_bak |grep -v swap &gt; /etc/fstab

<span style=color:#75715e># 配置K8S的yum源</span>
cat <span style=color:#e6db74>&lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo
</span><span style=color:#e6db74>[kubernetes]
</span><span style=color:#e6db74>name=Kubernetes
</span><span style=color:#e6db74>baseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64
</span><span style=color:#e6db74>enabled=1
</span><span style=color:#e6db74>gpgcheck=0
</span><span style=color:#e6db74>repo_gpgcheck=0
</span><span style=color:#e6db74>gpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg
</span><span style=color:#e6db74>       http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg
</span><span style=color:#e6db74>EOF</span>

<span style=color:#75715e># 卸载旧版本</span>
yum remove -y kubelet kubeadm kubectl

<span style=color:#75715e># 安装kubelet、kubeadm、kubectl</span>
<span style=color:#75715e># 将 ${1} 替换为 kubernetes 版本号，例如 1.20.1</span>
yum install -y kubelet-<span style=color:#e6db74>${</span>1<span style=color:#e6db74>}</span> kubeadm-<span style=color:#e6db74>${</span>1<span style=color:#e6db74>}</span> kubectl-<span style=color:#e6db74>${</span>1<span style=color:#e6db74>}</span>

crictl config runtime-endpoint /run/containerd/containerd.sock

<span style=color:#75715e># 重启 docker，并启动 kubelet</span>
systemctl daemon-reload
systemctl enable kubelet <span style=color:#f92672>&amp;&amp;</span> systemctl start kubelet

containerd --version
kubelet --version
</code></pre></div><h2 id=初始化-master-节点>初始化 master 节点<a hidden class=anchor aria-hidden=true href=#初始化-master-节点>#</a></h2>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># 只在 master 节点执行</span>
<span style=color:#75715e># 替换 x.x.x.x 为 master 节点的内网IP</span>
<span style=color:#75715e># export 命令只在当前 shell 会话中有效，开启新的 shell 窗口后，如果要继续安装过程，请重新执行此处的 export 命令</span>
export MASTER_IP<span style=color:#f92672>=</span>x.x.x.x
<span style=color:#75715e># 替换 apiserver.demo 为 您想要的 dnsName</span>
export APISERVER_NAME<span style=color:#f92672>=</span>apiserver.demo
<span style=color:#75715e># Kubernetes 容器组所在的网段，该网段安装完成后，由 kubernetes 创建，事先并不存在于您的物理网络中</span>
export POD_SUBNET<span style=color:#f92672>=</span>10.100.0.1/16
echo <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>MASTER_IP<span style=color:#e6db74>}</span><span style=color:#e6db74>    </span><span style=color:#e6db74>${</span>APISERVER_NAME<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> &gt;&gt; /etc/hosts
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e>#!/bin/bash
</span><span style=color:#75715e></span>
<span style=color:#75715e># 只在 master 节点执行</span>

<span style=color:#75715e># 脚本出错时终止执行</span>
set -e

<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>${#</span>POD_SUBNET<span style=color:#e6db74>}</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>||</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>${#</span>APISERVER_NAME<span style=color:#e6db74>}</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
  echo -e <span style=color:#e6db74>&#34;\033[31;1m请确保您已经设置了环境变量 POD_SUBNET 和 APISERVER_NAME \033[0m&#34;</span>
  echo 当前POD_SUBNET<span style=color:#f92672>=</span>$POD_SUBNET
  echo 当前APISERVER_NAME<span style=color:#f92672>=</span>$APISERVER_NAME
  exit <span style=color:#ae81ff>1</span>
<span style=color:#66d9ef>fi</span>


<span style=color:#75715e># 查看完整配置选项 https://godoc.org/k8s.io/kubernetes/cmd/kubeadm/app/apis/kubeadm/v1beta2</span>
rm -f ./kubeadm-config.yaml
cat <span style=color:#e6db74>&lt;&lt;EOF &gt; ./kubeadm-config.yaml
</span><span style=color:#e6db74>---
</span><span style=color:#e6db74>apiVersion: kubeadm.k8s.io/v1beta2
</span><span style=color:#e6db74>kind: ClusterConfiguration
</span><span style=color:#e6db74>kubernetesVersion: v${1}
</span><span style=color:#e6db74>imageRepository: registry.aliyuncs.com/k8sxio
</span><span style=color:#e6db74>controlPlaneEndpoint: &#34;${APISERVER_NAME}:6443&#34;
</span><span style=color:#e6db74>networking:
</span><span style=color:#e6db74>  serviceSubnet: &#34;10.96.0.0/16&#34;
</span><span style=color:#e6db74>  podSubnet: &#34;${POD_SUBNET}&#34;
</span><span style=color:#e6db74>  dnsDomain: &#34;cluster.local&#34;
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>---
</span><span style=color:#e6db74>apiVersion: kubelet.config.k8s.io/v1beta1
</span><span style=color:#e6db74>kind: KubeletConfiguration
</span><span style=color:#e6db74>cgroupDriver: systemd
</span><span style=color:#e6db74>EOF</span>

<span style=color:#75715e># kubeadm init</span>
<span style=color:#75715e># 根据您服务器网速的情况，您需要等候 3 - 10 分钟</span>
echo <span style=color:#e6db74>&#34;&#34;</span>
echo <span style=color:#e6db74>&#34;抓取镜像，请稍候...&#34;</span>
kubeadm config images pull --config<span style=color:#f92672>=</span>kubeadm-config.yaml
echo <span style=color:#e6db74>&#34;&#34;</span>
echo <span style=color:#e6db74>&#34;初始化 Master 节点&#34;</span>
kubeadm init --config<span style=color:#f92672>=</span>kubeadm-config.yaml --upload-certs

<span style=color:#75715e># 配置 kubectl</span>
rm -rf /root/.kube/
mkdir /root/.kube/
cp -i /etc/kubernetes/admin.conf /root/.kube/config

<span style=color:#75715e># 安装 calico 网络插件</span>
<span style=color:#75715e># 参考文档 https://docs.projectcalico.org/v3.13/getting-started/kubernetes/self-managed-onprem/onpremises</span>
echo <span style=color:#e6db74>&#34;&#34;</span>
echo <span style=color:#e6db74>&#34;安装calico-3.17.1&#34;</span>
rm -f calico-3.17.1.yaml
kubectl create -f https://kuboard.cn/install-script/v1.20.x/calico-operator.yaml
wget https://kuboard.cn/install-script/v1.20.x/calico-custom-resources.yaml
sed -i <span style=color:#e6db74>&#34;s#192.168.0.0/16#</span><span style=color:#e6db74>${</span>POD_SUBNET<span style=color:#e6db74>}</span><span style=color:#e6db74>#&#34;</span> calico-custom-resources.yaml
kubectl create -f calico-custom-resources.yaml
</code></pre></div><p><strong>检查 master 初始化结果</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># 只在 master 节点执行</span>

<span style=color:#75715e># 执行如下命令，等待 3-10 分钟，直到所有的容器组处于 Running 状态</span>
watch kubectl get pod -n kube-system -o wide

<span style=color:#75715e># 查看 master 节点初始化结果</span>
kubectl get nodes -o wide
</code></pre></div><h2 id=初始化-worker节点>初始化 worker节点<a hidden class=anchor aria-hidden=true href=#初始化-worker节点>#</a></h2>
<h3 id=获得-join命令参数>获得 join命令参数<a hidden class=anchor aria-hidden=true href=#获得-join命令参数>#</a></h3>
<p><strong>在 master 节点上执行</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubeadm token create --print-join-command
</code></pre></div><p>可获取kubeadm join 命令及参数，如下所示</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># kubeadm token create 命令的输出</span>
kubeadm join apiserver.demo:6443 --token mpfjma.4vjjg8flqihor4vt     --discovery-token-ca-cert-hash sha256:6f7a8e40a810323672de5eee6f4d19aa2dbdb38411845a1bf5dd63485c43d303
</code></pre></div><h3 id=初始化worker>初始化worker<a hidden class=anchor aria-hidden=true href=#初始化worker>#</a></h3>
<p><strong>针对所有的 worker 节点执行</strong></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># 只在 worker 节点执行</span>
<span style=color:#75715e># 替换 x.x.x.x 为 master 节点的内网 IP</span>
export MASTER_IP<span style=color:#f92672>=</span>x.x.x.x
<span style=color:#75715e># 替换 apiserver.demo 为初始化 master 节点时所使用的 APISERVER_NAME</span>
export APISERVER_NAME<span style=color:#f92672>=</span>apiserver.demo
echo <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>MASTER_IP<span style=color:#e6db74>}</span><span style=color:#e6db74>    </span><span style=color:#e6db74>${</span>APISERVER_NAME<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> &gt;&gt; /etc/hosts

<span style=color:#75715e># 替换为 master 节点上 kubeadm token create 命令的输出</span>
kubeadm join apiserver.demo:6443 --token mpfjma.4vjjg8flqihor4vt     --discovery-token-ca-cert-hash sha256:6f7a8e40a810323672de5eee6f4d19aa2dbdb38411845a1bf5dd63485c43d303
 
</code></pre></div><h3 id=检查初始化结果>检查初始化结果<a hidden class=anchor aria-hidden=true href=#检查初始化结果>#</a></h3>
<p>在 master 节点上执行</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get nodes -o wide
</code></pre></div><p>输出结果如下所示：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#f92672>[</span>root@k8s-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kubectl get nodes</span>
NAME         STATUS   ROLES    AGE     VERSION
k8s-master   Ready    master   3m46s   v1.17.4
k8s-node     Ready    &lt;none&gt;   2m20s   v1.17.4
</code></pre></div>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://blog.bitqiu.cc/tags/kubernetes/>kubernetes</a></li>
<li><a href=https://blog.bitqiu.cc/tags/ops/>ops</a></li>
</ul>
<nav class=paginav>
<a class=next href=https://blog.bitqiu.cc/posts/kong-jwt/>
<span class=title>Next Page »</span>
<br>
<span>Kong 基本用法 + JWT</span>
</a>
</nav>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share 使用 kubeadm 安装 kubernetes on twitter" href="https://twitter.com/intent/tweet/?text=%e4%bd%bf%e7%94%a8%20kubeadm%20%e5%ae%89%e8%a3%85%20kubernetes&url=https%3a%2f%2fblog.bitqiu.cc%2fposts%2fuse-kubeadm-install-kubernetes%2f&hashtags=kubernetes%2cops"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share 使用 kubeadm 安装 kubernetes on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.bitqiu.cc%2fposts%2fuse-kubeadm-install-kubernetes%2f&title=%e4%bd%bf%e7%94%a8%20kubeadm%20%e5%ae%89%e8%a3%85%20kubernetes&summary=%e4%bd%bf%e7%94%a8%20kubeadm%20%e5%ae%89%e8%a3%85%20kubernetes&source=https%3a%2f%2fblog.bitqiu.cc%2fposts%2fuse-kubeadm-install-kubernetes%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share 使用 kubeadm 安装 kubernetes on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.bitqiu.cc%2fposts%2fuse-kubeadm-install-kubernetes%2f&title=%e4%bd%bf%e7%94%a8%20kubeadm%20%e5%ae%89%e8%a3%85%20kubernetes"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share 使用 kubeadm 安装 kubernetes on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.bitqiu.cc%2fposts%2fuse-kubeadm-install-kubernetes%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share 使用 kubeadm 安装 kubernetes on whatsapp" href="https://api.whatsapp.com/send?text=%e4%bd%bf%e7%94%a8%20kubeadm%20%e5%ae%89%e8%a3%85%20kubernetes%20-%20https%3a%2f%2fblog.bitqiu.cc%2fposts%2fuse-kubeadm-install-kubernetes%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share 使用 kubeadm 安装 kubernetes on telegram" href="https://telegram.me/share/url?text=%e4%bd%bf%e7%94%a8%20kubeadm%20%e5%ae%89%e8%a3%85%20kubernetes&url=https%3a%2f%2fblog.bitqiu.cc%2fposts%2fuse-kubeadm-install-kubernetes%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://blog.bitqiu.cc/>Bitqiu</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)">
<button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</button>
</a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>